# 要求定義書: プロジェクト整合性の修正

## 概要

現在のプロジェクトには、構造変更の未完了、設定とドキュメントの不整合、未コミットの大量変更など、複数の整合性問題が存在します。本作業では、これらの問題を解消し、プロジェクトを安定した状態に整えます。

## 背景

- 記事フォルダ構造が年月ベース（`2025/09/`）からカテゴリベースへ移行中
- Git status に 385 ファイルの変更が未コミット状態で残存
- `config.toml` と `docs/architecture.md` の設定内容が乖離

## 要求事項

### 1. 設定ファイルとドキュメントの同期

**現状の問題:**
- `config.toml` から `[markdown]` ブロック（数式レンダリング、コードハイライト設定）が削除されている
- `docs/architecture.md` には旧設定が記載されたまま

**要求:**
- 数式レンダリング（`render_math`）とコードハイライト（`highlight_code`）を有効化するか無効化するか方針を決定
- 決定した方針に基づき、`config.toml` と `docs/architecture.md` を同期

### 2. Git ワーキングツリーの整理

**現状の問題:**
- 234 ファイルが削除予定（旧構造の記事・画像）
- 151 ファイルが新規追加（新構造の記事、docs/、.vscode/ 等）
- 変更がコミットされておらず、作業履歴が不明確

**要求:**
- 現在の変更内容を確認し、適切にステージング・コミット
- 構造変更の意図と経緯を commit メッセージに明記

### 3. 処理済み画像の整理

**現状の問題:**
- `static/processed_images/` に jpg と webp 形式が混在
- 旧構造で使用されていた画像ファイルも残存

**要求:**
- 使用されていない処理済み画像を特定・削除
- 画像形式の方針を明確化（webp 優先等）

### 4. ビルド検証

**要求:**
- `zola build` でエラーが発生しないことを確認
- 全記事が正常にレンダリングされることを確認

## 受け入れ条件

- [ ] `config.toml` と `docs/architecture.md` の設定が一致している
- [ ] Git working tree がクリーンな状態（未コミット変更なし）
- [ ] `zola build` が警告なしで成功する
- [ ] 全記事ページが正常に表示される

## 制約事項

- 既存の記事コンテンツは保持する（内容の削除不可）
- URL 構造は現状を維持する（SEO への影響回避）
- デプロイパイプライン（GitHub Actions + Cloudflare Pages）への影響を最小化

## 優先度

高 - プロジェクトの基盤整備として早急に対応が必要
